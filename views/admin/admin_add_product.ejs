<%- include ('partialsAdminHead') %>
<style>

        
  .preview-image {
    max-width: 200px;
    max-height: 200px;
    margin-top: 10px;
  }

      #image-preview {
        display: flex;
        flex-wrap: wrap;
      }
      .preview-container {
        position: relative;
        width: 120px;
        height: 120px;
        border: 2px solid #ddd;
        border-radius: 5px;
        overflow: hidden;
        margin: 5px;
      }
      .preview-container img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      .remove-btn {
        position: absolute;
        top: 5px;
        right: 5px;
        background-color: rgba(34, 148, 53, 0.8);
        border: none;
        border-radius: 50%;
        padding: 5px;
        cursor: pointer;
      }
    </style>
<nav>
  <ul class="menu-aside">
    <li class="menu-item">
      <a class="menu-link" href="/admin/dashboard">
        <i class="icon material-icons md-home"></i>
        <span class="text">Dashboard</span>
      </a>
    </li>
    <li class="menu-item">
      <a class="menu-link" href="/admin/category">
        <i class="icon material-icons md-shopping_bag"></i>
        <span class="text">Categories</span>
      </a>
    </li>
    <li class="menu-item ">
      <a class="menu-link" href="/admin/user">
        <i class="icon material-icons md-store"></i>
        <span class="text">Users</span>
      </a>
    </li>
    <li class="menu-item active">
      <a class="menu-link" href="/admin/product">
        <i class="icon material-icons md-add_box"></i>
        <span class="text">Products</span>
      </a>
    </li>
    <li class="menu-item">
      <a class="menu-link" href="/admin/order">
        <i class="icon material-icons md-store"></i>
        <span class="text">Orders</span>
      </a>
    </li>
    <!-- WILL ADD IT IN COMING WEEK  -->
    
    <!--<li class="menu-item">
      <a class="menu-link" href="page-transactions-1.html">
        <i class="icon material-icons md-monetization_on"></i>
        <span class="text">Coupons</span>
      </a>
    </li> -->
  <br />
  <br />
</nav>
</aside>
    <main class="main-wrap">
      <header class="main-header navbar">
        <div class="col-search">
          <!-- <form class="searchform">
            <div class="input-group">
              <input
                list="search_terms"
                type="text"
                class="form-control"
                placeholder="Search term"
              />
              <button class="btn btn-light bg" type="button">

                <i class="material-icons md-search"></i>
              </button>
            
            </div>
            <datalist id="search_terms">
              
            </datalist>
          </form> -->
        </div>
        <div class="col-nav" onload="timeCount();">
          <p id="p1">
            
          </p>
      
  </div>
        <div class="col-nav">
          
          <p>
            
            Welcome back, <%=name %> </p>
      
  </div>


        <div class="col-nav">
              <li class="dropdown nav-item">
                <button class="btn btn-link" type="submit"> <a href="/admin/signout" ><i class="material-icons md-exit_to_app"></i>Logout</a></button>
            
              </li>
          </ul>
      </div>

      </header>
      <section class="content-main">
        <div class="content-header">
          <div>
            <h2 class="content-title card-title">Add products</h2>
            <p>Add products here</p>
          </div>
          
        </div>
        
        <!-- card-header end// -->
        <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-6">
        <div class="card">
          <div class="card-body">
            <!-- <h1 class="card-title text-center mb-4">Edit User</h1> -->
            <div class="container mt-5">
  <!-- <h2 class="mb-4">Add Product</h2> -->
  <form action="/admin/product" method="post" enctype="multipart/form-data">
    <div class="form-group">
      <label for="productName" style="color:green; font-size: medium;">Product Name:<sup style="line-height: 120%; color: red;">*</sup></label>
      <input type="text" class="form-control" id="productName" placeholder="Product name" name="prodName" minlength="4" required>
    </div>
    <div class="form-group" style="padding-top: 3%;">
      <label for="productDescription" style="color:green; font-size: medium;">Product Description:<sup style="line-height: 120%; color: red;">*</sup></label>
      <textarea class="form-control" id="productDescription" rows="3" placeholder="Product description" name="prodDesc" minlength="10" maxlength="100" required></textarea>
    </div>
    <div class="form-group" style="padding-top: 3%;">
      <label for="productPrice" style="color:green; font-size: medium;">Product Price:<sup style="line-height: 120%; color: red;">*</sup></label>
      <input type="number" class="form-control" id="productPrice" placeholder="Product price" name="productPrice" required min="100" required>
    </div>
    <div class="form-group" style="padding-top: 3%;">
      <label for="discount" style="color:green; font-size: medium;">Discount %:<sup style="line-height: 120%; color: red;">*</sup></label>
      <input type="" class="form-control" id="discount" placeholder="Discount percentage" name="discount" min="1" required>
    </div>
    <div class="form-group" style="padding-top: 3%;">
      <label for="DiscountedPrice" style="color:green; font-size: medium;">Discounted Price:<sup style="line-height: 120%; color: red;">*</sup></label>
      <input type="number" class="form-control" id="DiscountedPrice" placeholder="Discounted Price" name="DiscountedPrice" readonly>
    </div>

    <div class="form-group" style="padding-top: 3%;">
    
      <label for="productCategory" style="color:green; font-size: medium;">Product Category:<sup style="line-height: 120%; color: red;">*</sup></label>
      <select class="form-control" id="productCategory" name="category" required>
        
        <option value="" selected disabled>Choose a category</option>
        <% for(let a of category) { %>
         <option value="<%=a.name %>"><%=a.name %></option> 
        <% } %>
      </select>
    </div>
    <div class="form-group" style="padding-top: 3%;">
      <label for="productQuantity" style="color:green; font-size: medium;">Product Quantity:<sup style="line-height: 120%; color: red;">*</sup></label>
      <input type="number" class="form-control" id="productQuantity" placeholder="Product quantity" name="quantity" required min="0">
    </div>
    <div class="form-group" style="padding-top: 3%;">
      <label for="productImage" style="color:green; font-size: medium;">Product Images:<sup style="line-height: 120%; color: red;">*</sup></label><br>
      <input type="file" class="form-control-file" id="productImage" name="images" multiple accept="image/*" required>
      <div id="image-preview" class="mt-3"></div>
    </div>
    <br><br>
    <button type="submit" class="btn btn-primary" onclick="myFunction()">Save it</button>
    <a style="margin:20%; color: red;" href="/admin/product">Go Back</a>
  </form>
  
</div>
             </div>
        </div>
      </div>
    </div>
  </div>
        <!-- row.// -->
        
      </section>
      <!-- content-main end// -->
    <%- include ('partialsAdminFooter') %>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <!-- image crop script-->
    <script defer src="https://cdn.crop.guide/loader/l.js?c=YTMSNG"></script> 
    <!-- image crop end-->
    <script>
    // To populate discounted product value in form//
    const productRateInput = document.getElementById("productPrice");
    const productDiscountInput = document.getElementById("discount");
    const productDiscountedInput = document.getElementById("DiscountedPrice");

    function calculateDiscountedValue() {
            const productRate = parseFloat(productRateInput.value);
            const discount = parseFloat(productDiscountInput.value);
            const discountedValue = productRate - (productRate * (discount / 100));

            productDiscountedInput.value = discountedValue; 
        }

        // Add event listeners to the product rate and discount input fields
        productDiscountInput.addEventListener('input', calculateDiscountedValue);


    </script>
    <script>
    document.getElementById('productImage').addEventListener('change', function() {
      const imagePreview = document.getElementById('image-preview');

        imagePreview.innerHTML = ''; // Clear previous previews
        var files = this.files;
        console.log("*********")
        console.log(files)
        console.log(files.length);
        
        for (let i = 0; i < files.length; i++) {
            const file = files[i];
            const reader = new FileReader();

            reader.onload = function(e) {
                const img = document.createElement('img');
                img.src = e.target.result;
                // img.width = 100; // Adjust as needed
                // img.height = 100; // Adjust as needed
                // img.style.marginBottom = '5px'; // Adjust as needed
                img.classList.add('preview-image');
                preview.appendChild(img);

                // const container = document.createElement('div');
                // container.classList.add('me-3', 'mb-3');
                // container.appendChild(img);
                //imagePreview.appendChild(container);
            };

            reader.readAsDataURL(file);
        }
    });
</script>
  </body>
</html>
